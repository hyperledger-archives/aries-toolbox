Connections Admin Protocol
==========================

## Overview

**Protocol URI:** `https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1`

### Protocol Messages
- [connection](#connection)
- [get-list](#get-list)
- [list](#list)
- [update](#update)
- [delete](#delete)
- [deleted](#deleted)
- [receive-invitation](#receive-invitation)
- [receive-oob-invitation](#receive-oob-invitation)
- [connected](#connected)

## Message Definitions

> _**Note:**_ Some attributes are omitted from the examples in this section,
> such as the `@id` attribute. The omission is for brevity and clarity of the
> example and it should be assumed that each example message contains all
> attributes required to be processed by the receiving agent.

### Connection
A representation of a connection as used by the toolbox.

The `connection` message is used as a response to several messages; where this
message is sent in response to another, the `thid` should be set to the ID of
the message that caused this message to be sent. Additionally a similar
structure is nested in other messages; where this structure is nested, the
`@type` attribute is omitted.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/connection",
  "connection_id": "c08fdc8b-2edc-499a-9f71-5c5960d6abc1",
  "label": "Bob",
  "my_did": "8zZRWsViMg1gc9GjcL6MFu",
  "state": "active",
  "their_did": "KHKqmY24wF6oHJ29iSNxir",
  "role": "",
  "raw_repr": {...},
}
```

`connection_id`: Identifier unique to this agent and used consistently across
all admin functions to identify a single connection.

`label`: The label for this connection.

`my_did`: My DID for this connection.

`state`: One of `active`, `pending`, or `error`.

`their_did` (Optional): Their DID for this connection. Optional as it may not be
present if the connection state is `pending`.

`role` (Optional): String representing the appointed role of this connection.

`raw_repr` (Optional): An optional dump of the Agent's connection object.

--------------------------------------------------------------------------------

### Get List
Request a current list of connections from the connected agent.

Example:
```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/get-list"
}
```

### List

Response message to `get-list`.

Example:
```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/list",
  "~thread": {"thid": "<get-list msg id>"},
  "connections": [{ ... }]
}
```

`~thread`: Thread ID will match the message ID of the corresponding `get-list`
message.

`connections`: List of connection objects; see [connection](#connection) for
details on attributes in each object.


--------------------------------------------------------------------------------

### Update

Update attributes of a connection. A [connection](#connection) message will be
sent in response to this message.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/update",
  "connection_id": "c08fdc8b-2edc-499a-9f71-5c5960d6abc1",
  "label": "new label",
  "role": "new role",
}
```

`connection_id`: ID of the connection to update.

`label` (optional): Update this connection's label with this value.
`role` (optional): Update this connection's role with this value.

--------------------------------------------------------------------------------

### Delete
Delete a connection. A [deleted](#deleted) message will be sent in response to
this message.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/delete",
  "connection_id": "c08fdc8b-2edc-499a-9f71-5c5960d6abc1"
}
```

`connection_id` (optional): Specify the connection to be deleted.

### Deleted

Acknowledge deletion of a connection. `thid` SHOULD be populated with message ID
of `delete` message.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/deleted",
  "~thread": {"thid": "<delete msg id>"},
  "connection_id": "d0b301be-b825-4fbe-bc35-67b49c7a5e38",
}
```

`connection_id` (optional): The connection ID specified by the `delete` message.

--------------------------------------------------------------------------------

### Receive Invitation

Create a new connection by receiving an invitation.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/receive-invitation",
  "invitation": "https://example.com?c_i=..."
  "auto_accept": true,
  "mediation_id": "cbf76a1c-aba9-4675-af64-a65ef116f359"
}
```

`invitation`: The invitation URL as generated by another agent.

`auto_accept` (Optional): Whether the agent should automatically accept the
given invitation or not.

`mediation_id` (Optional): Identifier for mediator to use when accepting this
invitation.

--------------------------------------------------------------------------------

### Receive OOB Invitation

Create a new connection by receiving an out-of-band invitation.

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/receive-oob-invitation",
  "invitation": "https://example.com?oob=..."
  "auto_accept": true,
  "mediation_id": "cbf76a1c-aba9-4675-af64-a65ef116f359"
}
```

--------------------------------------------------------------------------------

### Connected

Notification of connection completed.

This message shares the same structure as [`connection`](#connection)

```jsonc
{
  "@type": "https://github.com/hyperledger/aries-toolbox/tree/master/docs/admin-connections/0.1/connected",
  "connection_id": "c08fdc8b-2edc-499a-9f71-5c5960d6abc1",
  "label": "Bob",
  "my_did": "8zZRWsViMg1gc9GjcL6MFu",
  "state": "active",
  "their_did": "KHKqmY24wF6oHJ29iSNxir",
  "raw_repr": {...},
}
```
